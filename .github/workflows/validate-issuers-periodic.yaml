name: "Validate on schedule"

on:
  schedule:
    # Minute Hour DayOfMonth Month DayOfWeek - runs every 4 hours
    # This only applies to whatever has been set as the main branch
    # https://docs.github.com/en/actions/reference/workflows-and-actions/events-that-trigger-workflows#schedule
    - cron:  '0 */4 * * *'

jobs:
  runTests:
    name: "Validate Issuers File"
    runs-on: [ubuntu-latest]
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
      - name: Cache Python venv
        uses: actions/cache@v4
        with:
          path: scripts/venv
          key: ${{ runner.os }}-build-${{ hashFiles('**/requirements.txt') }}

      - name: "Validate Issuers File"
        run: |
          cd scripts
          python -m venv venv
          source venv/bin/activate
          pip install -r requirements.txt
          python validate_entries.py ../vci-issuers.json
